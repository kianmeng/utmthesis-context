% !TEX TS-program = context (luatex)
% !TEX encoding = UTF-8 Unicode
% !TEX root = thesis.tex
% !TeX spellcheck = en-US
% !BIB program = bibtex
% @see https://tex.stackexchange.com/q/78101/34697

% Enable / Disable these to troubleshoot any layout issues.
% \showlayout
% \showsetups
% \showgrid
% \showmakeup
% \showframe
% \showbodyfontenvironment
\enabletrackers[fonts.missing]

\usemodule[visual]

% @see http://wiki.contextgarden.net/Bibliography_mkiv
\usebtxdataset[bibliography.bib]
\usebtxdefinitions[apa]
\setupbtx[default:cite][alternative=authoryear]

\setuppapersize[A4][A4]
\setupbodyfont[times,12pt]
\setuplayout[
    backspace=4cm,
    topspace=1.25cm,
    header=1.25cm,
    footer=1.25cm,
    cutspace=2.5cm,
    height=middle,
    width=middle,
]

% @see http://wiki.contextgarden.net/Command/setupinterlinespace
% Double spacing is line=5.6ex and one and half spacing is line=4.2ex.
% However, closest we can get like MS Word 1.5 line spacing.
\setupinterlinespace[line=3.8ex]

% @see http://wiki.contextgarden.net/Command/setuppagenumbering
\setuppagenumbering[location={header,right},alternative=singlesided]

\setuplabeltext[chapter=CHAPTER~]
\setuphead[chapter][
    textstyle=cap,
    header=empty,
    alternative=middle,
    style=bold,
    numbercommand=\groupedcommand{\blank[1.5cm]}{\blank[4*line]},
    after={\blank[4*line]},
]

\setuphead[title][
    textstyle=cap,
    header=nomarking,
    style=bold,
    alternative=middle,
    style=bold,
]

% @see http://wiki.contextgarden.net/Command/setupindenting
% @see http://wiki.contextgarden.net/Indentation
% Indent all paragraph after all section headers.
\setupindenting[yes, 1.27cm, first]
\setupheads[section, subsection][
    indentnext=yes,
    numberwidth=1.27cm,
    style=bold,
    before={\blank[3*line]},
    after={\blank[1*line]}
]

\setupheads[subsubsection][
    indentnext=yes,
    numberwidth=1.27cm,
    style=bold,
    before={\blank[1*line]},
    after={\blank[1*line]}
]

\starttext
\input 01_title

\startfrontmatter
    \definehead[headers][title]
    \setuphead[headers][
        style={\WORD\bf},
        incrementnumber=list,
    ]

    \setupheadtext[content=Table of Contents]
    \setuphead[title][incrementnumber=list]
    \setupcombinedlist[content][
        list={headers,title,chapter,section,subsection, subsubsection},
        alternative=b,
    ]

    \setuplist[headers][margin=0mm, style={\WORD\bf}, pagestyle={\word}, pagenumber=no, after={\blank[1*line]}]
    \setuplist[title][margin=30mm, style={\WORD\bf}, pagestyle={\word}]
    \setuplist[chapter][margin=10mm, width=20mm, style={\WORD\bf}, pagestyle={\word}]
    \setuplist[section][width=18mm, margin=30mm]
    \setuplist[subsection][width=18mm, margin=48mm]
    \setuplist[subsubsection][width=18mm, margin=66mm]

    \definestructureconversionset[frontpart:pagenumber][][romannumerals]
    \definestructureconversionset[bodypart:pagenumber][][numbers]

    \writetolist[headers]{}{Chapter \hfill Title \hfill Page}

    \setuppagenumber[number=2]
    \input 02_declaration
    \input 03_dedication

    \input 04_acknowledgement
    \input 05_abstract
    \input 06_abstrak
    \completecontent

    \title{List of Tables}
    \startcolumns[n=3]
        \bf{TABLE NO.}
        \column \bf{TITLE}
        \column \hfill \bf{PAGE}
    \stopcolumns
    \blank[0.5em]
    \placelist[table,widetable]

    \title{List of Figures}
    \startcolumns[n=3]
        \bf{FIGURE NO.}
        \column \bf{TITLE}
        \column \hfill \bf{PAGE}
    \stopcolumns
    \blank[0.5em]
    \placelist[figure,widetable]

    \title{List of Abbreaviations}
    \title{List of Symbols}

    \title{List of Appendices}
    \startcolumns[n=3]
        \bf{APPENDIX}
        \column \bf{TITLE}
        \column \hfill \bf{PAGE}
    \stopcolumns
    \blank[0.5em]

\stopfrontmatter

\setupwhitespace[line]
\startbodymatter
    \setuppagenumber[number=1]
    \input chapter01
    \input chapter02
    \input chapter03
    \input chapter06
\stopbodymatter

\startbackmatter
    \startchapter[title=References]
        \placelistofpublications
    \stopchapter
\stopbackmatter

%\startappendices
%\stopappendices

\stoptext
